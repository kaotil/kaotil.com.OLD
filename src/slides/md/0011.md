# My aws - Lambda + API Gateway + DynamoDB 前編

@kaotil

2016/00/00



## Lambda と API Gateway を使ってみたい

勉強会のスライド一覧を、API Gateway 経由で Lambda を実行して DynamoDB に登録、更新、削除、取得するするようにしよう。



### イメージ図

Java Scriptから呼び出したい

![イメージ](/slides/img/0011/lambda_diagram.png)<!-- .element: class="img_80" -->



### 1. Lambdaを始める

![Lambdaトップ](/slides/img/0011/lambda_get_start.png)<!-- .element: class="img_60" -->



### 2. blue print(ひな型) から選ぶ 

「microservice-http-endpoint」が使えそうなのでこれを選ぶ

![blue print](/slides/img/0011/lambda_select_blueprint.png)<!-- .element: class="img_60" -->



### 3. Configure triggers

![Configure triggers](/slides/img/0011/lambda_configure_triggers.png)<!-- .element: class="img_60" -->



- 設定値
  - API name: SlideService
  - Resource name: /slide
  - Method: POST
  - Deployment stage: prod
  - Security: Open

- Securityは、AWS IAM、Open、Open with access keyがあるけど、Openにして認証は別途検討する。



### 4. Configure function 1

画面が長いので5つに分けます

![Configure function1](/slides/img/0011/lambda_configure_function1.png)<!-- .element: class="img_60" -->

- 設定値
  - Name: slideApiTest
  - Description: デフォルト値
  - Runtime: Node.js 4.3



### 4. Configure function 2

![Configure function2](/slides/img/0011/lambda_configure_function2.png)<!-- .element: class="img_60" -->

Lambda function のコードがあって



### 4. Configure function 3 

![Configure function3](/slides/img/0011/lambda_configure_function3.png)<!-- .element: class="img_60" -->

- Roleを新規で作る
  - Role name: lambda_slide_function_role
  - Policy templates: デフォルト値



### 4. Configure function 4

![Configure function4](/slides/img/0011/lambda_configure_function4.png)<!-- .element: class="img_60" -->

- 初期値そのままにした



### 5. Review 

![Review](/slides/img/0011/lambda_review.png)<!-- .element: class="img_60" -->

Create functionボタンを押す



### 6. 出来た 

![Result](/slides/img/0011/lambda_result.png)<!-- .element: class="img_80" -->

APIのURLが出てる


### DynamoDB作る



### API Gateway 確認



### API叩く



# 参考サイト

(Amazon API Gateway の API を Cognito で認証して呼び出す)[http://dev.classmethod.jp/cloud/aws/api-gateway-cognito-auth/]
(（祝）AWS LambdaのVPC利用が可能になりました)[http://dev.classmethod.jp/cloud/aws/aws-lambda-vpc/]












